<html>

<head>
	<title>SWORD 2.0 Profile</title>
	<style type="text/css">

.code {
	font-family: monospace;
	background: #ffffaa;
	padding-left: 15px;
	padding-right: 15px;
	padding-top: 5px;
	padding-bottom: 5px;
	margin-top: 5px;
	margin-bottom: 5px;
}

.code_inline {
	font-family: monospace;
	background: #ffffaa;
	padding-right: 5px;
	padding-left: 5px;
	padding-top: 3px;
	padding-bottom: 3px;
}

	</style>
</head>
<body>

<h1>SWORD 2.0 Profile</h1>

<a href="#introduction">1. Introduction</a><br/>
<a href="#notationalconventions">2. Notational Conventions</a><br/>
<a href="#terminology">3. Terminology</a><br/>
<a href="#namespaces">4. Namespaces</a><br/>
&nbsp;&nbsp;<a href="#namespaces_sword">4.1. SWORD Namespaces</a><br/>
&nbsp;&nbsp;<a href="#namespaces_referenced">4.2. Referenced Namespaces</a><br/>
<a href="#uris">5. URIs</a><br/>
<a href="#protocoloperations">6. Protocol Operations</a><br/>
&nbsp;&nbsp;<a href="#protocoloperations_retreivingservicedocument">6.1 Retrieving a Service Document</a><br/>
&nbsp;&nbsp;<a href="#protocoloperations_listingcollections">6.2 Listing Collections</a><br/>
&nbsp;&nbsp;<a href="#protocoloperations_creatingresource">6.3. Creating a Resource</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#protocoloperations_creatingresource_binary">6.3.1. Creating a Resource with a Binary File Deposit</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#protocoloperations_creatingresource_multipart">6.3.2. Creating a Resource with a Multipart Deposit</a><br/>
&nbsp;&nbsp;<a href="#protocoloperations_retrievingcontent">6.4. Retrieving the content</a><br/>
&nbsp;&nbsp;<a href="#protocoloperations_editingcontent">6.4. Editing the Content of a Resource</a><br/>
&nbsp;&nbsp;<a href="#protocoloperations_deletingcontent">6.5. Deleting the Content of a Resource</a><br/>
&nbsp;&nbsp;<a href="#protocoloperations_addingcontent">6.6. Adding Content to a Resource</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#protocoloperations_addingcontent_binary">6.6.1. Adding New Packages or Files to a Container</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#protocoloperations_addingcontent_metadata">6.6.2. Adding New Metadata to a Resource</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#protocoloperations_addingcontent_multipart">6.6.3. Adding New Metadata and Packages or Files to a Resource with Multipart</a><br/>
&nbsp;&nbsp;<a href="#protocoloperations_deleteconteiner">6.7. Delete the Container</a><br/>
&nbsp;&nbsp;<a href="#protocoloperations_statement">6.8. Retrieving the Statement</a><br/>
<a href="#packaging">7. Packaging</a><br/>
&nbsp;&nbsp;<a href="#packaging_servicedescription">7.1. Package support in Service description</a>

<h2><a name="introduction">1. Introduction</a></h2>

<p>
The Atom Publishing Protocol ([<a href="#atompub">AtomPub</a>]) provides a simple, extensible mechanism for the creation of Web Resources. The SWORD profile builds upon AtomPub and HTTP ([<a href="#rfc2616">RFC2616</a>]) and incorporates a number of extensions to enable the following kinds of behaviours:
</p>

<ul>
<li>Clients may create resources by sending compound resources, such as archive files (tar, zip).</li>
<li>Both non-interactive and 3rd party mediated operation are required.</li>
<li>Workflows which may or may not include manual stages before deposited resources become available as web resources.</li>
<li>Clients may update or delete parts of the compound resources or associated metadata</li>
<li>Clients may display the state and server description of deposited resources to users</li>
</ul>

<p>
The practical details of the extensions used in the SWORD Profile are provided in the following Internet Drafts:
</p>

<ol>
<li>Packaged Content Delivery over HTTP [<a href="sword001">SWORD001</a>]</li>
<li>AtomPub Extensions for Packaged Content [<a href="sword0002">SWORD002</a>]</li>
<li>AtomPub Extensions for SWORD [<a href="sword0003">SWORD003</a>]</li>
<li>Atom Multipart Extensions for Packaged Content [<a href="sword0004">SWORD004</a>]</li>
</ol>

<h2><a name="notationalconventions">2. Notational Conventions</a></h2>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [<a href="rfc2119">RFC2119</a>].
</p>

<h2><a name="terminology">3. Terminology</a></h2>

<p>
Throughout this document we will regularly refer to identifiers which are used by SWORD.  The following URIs are part of the specification:
</p>

<dl>
<dt><strong>SD-URI</strong></dt>
<dd>The <strong>Service Document URI</strong>. This is the URI from which the root service document can be located. If the server supports nesting of service documents, then these sub-service documents are also subject to the same rules as <strong>SD-URI</strong> and should be considered the same.</dd>

<dt><strong>Col-URI</strong></dt>
<dd>The URI of a <strong>SWORD Collection</strong>. This is the URI to which the initial deposit will take place, and which are listed in the <strong>Service Document</strong>.</dd>

<dt><strong>Cont-URI</strong><dt>
<dd>The <strong>Content URI</strong>. This is the URI from which the client will be able to retrieve representations of the object as it resides in the SWORD server (which representation is returned will be through package format negotiation, as discussed later).</dd>

<dt><strong>EM-URI</strong></dt>
<dd>The <strong>Atom Edit Media URI</strong>. This is almost always going to be the same as the <strong>Cont-URI</strong>, but the Atom spec requires that these identifiers be allowed to differ [<a href="#atompub">AtomPub</a>].  Throughout this document we will mostly refer to the <strong>EM-URI</strong>.  An important thing to note about the <strong>EM-URI</strong> and the <strong>Cont-URI</strong> is that they do not refer to the resource as deposited by the client (e.g. the original zip), but to all the content stored in the item on the server, and the format that this URI returns is obtained by content negotiation.  This will be discussed in more detail in the <a href="#depositreceipt">Deposit Receipt section</a>.</dd>

<dt><strong>Edit-URI</strong></dt>
<dd>The <strong>Atom Media Edit URI</strong>. This is the URI of the Atom Entry of the object, and therefore also of the container within the SWORD server.</dd>

<dt><strong>State-URI</strong></dt>
<dd>The <strong>SWORD Statement URI</strong>.  This is one of the URIs which can be used to retrieve a description of the object from the sword server, including the structure of the object and its state.</dd>
</dl>

<h2><a name="namespaces">4. Namespaces</a></h2>

<h3><a name="namespaces_sword">4.1. SWORD Namespaces</a></h3>

<p>
All SWORD extensions are defined within the namespace:
</p>

<div class="code">
http://purl.org/net/sword/
</div>

<p>
Beneath this URI, we use the following extensions for the various parts of the standard:
</p>

<p>
For all predicates associated with SWORD:
</p>

<div class="code">
http://purl.org/net/sword/terms/
</div>

<p>
This document uses the prefix <strong>sword</strong> for this namespace name; for example <strong>sword:originalDeposit</strong>
</p>

<p>
Root registry for any SWORD recognised package formats including "default":
</p>

<div class="code">
    http://purl.org/net/sword/package/
</div>

<p>
Root namespace for any Error documents which SWORD can produce:
</p>

<div class="code">
    http://purl.org/net/sword/error/
</div>

<p>
Root namespace for any State terms that SWORD wishes to provide:
</p>

<div class="code">
    http://purl.org/net/sword/state/
</div>


<h3><a name="namespaces_referenced">4.2. Referenced Namespaces</a></h3>

<p>
The AtomPub [<a href="#atompub">AtomPub</a>] namespace is:
</p>

<div class="code">
    http://www.w3.org/2007/app
</div>

<p>
This document uses the prefix <strong>app</strong> for the namespace name; for example <strong>app:collection</strong>.
</p>

<p>
The Atom Syndication Format [<a href="#atom">Atom</a>] namespace is:
</p>

<div class="code">
    http://www.w3.org/2005/Atom
</div>

<p>
This document uses the prefix <strong>atom</strong> for the namespace name; for example <strong>atom:feed</strong>
</p>

<p>
The DCMI Terms [<a href="#dublincore">DublinCore</a>] namespace is:
</p>

<div class="code">
    http://purl.org/dc/terms/
</div>

<p>
This document uses the prefix <strong>dcterms</strong> for the namespace name; for example <strong>dcterms:title</strong>
</p>

<p>
The RDF [<a href="#rdf">RDF</a>] namespace is:
</p>

<div class="code">
    http://www.w3.org/1999/02/22-rdf-syntax-ns#
</div>

<p>
This document uses the prefix <strong>rdf</strong> for the namespace name; for example <strong>rdf:Description</strong>
</p>

<p>
The OAI-ORE [<a href="oaiore">OAIORE</a>] namespace is:
</p>

<div class="code">
        http://www.openarchives.org/ore/terms/
</div>

<p>
This document uses the prefix <strong>ore</strong> for the namespace name; for example <strong>ore:aggregates</strong>
</p>


<h2><a name="uris">5. URIs</a></h2>

<p>
The default packaging format, which represents a plain ZIP file during resource creation or update, or a ZIP file + Atom embedded DC metadata during Atom Multipart [<a href="#atommultipart">AtomMultipart</a>] deposit
</p>

<div class="code">
    http://purl.org/net/sword/package/default
</div>

<p>
The packaging format which represents a binary file which should not be unpacked by the server
</p>

<div class="code">
    http://purl.org/net/sword/package/binary
</div>

<h2><a name="protocoloperations">6. Protocol Operations</a></h2>

<p>
While specific HTTP status codes are used below, a SWORD client should be prepared to handle any status code as per the HTTP status code definitions [<a href="#rfc2616">RFC2616</a>]
</p>

<h3><a name="protocoloperations_retreivingservicedocument">6.1 Retrieving a Service Document</a></h3>

<em>See Sections 5.1 and 8 of [<a href="#atompub">AtomPub</a>], for details.</em>

<ol>
<li>The client sends a GET request to the URI of the Service Document.</li>
<li>The server responds with a Service Document enumerating the IRIs of a group of Collections and the capabilities of those Collections supported by the server. The content of this document can vary based on aspects of the client request, including, but not limited to, authentication credentials.</li>
</ol>

<p>
The client may also supply the <span class="code_inline">On-Behalf-Of</span> header [<a href="sword001">SWORD001</a>] to provide the username of a target user on whose behalf a deposit will be made.  See <a href="#authenticationmediatedeposit">Section 8: Authentication and Mediated Deposit</a> for more details.
</p>

<div class="code">
<pre>
GET SD-URI HTTP/1.1
Authorization: Basic ZGFmZnk6c2VjZXJldA==
Host: example.org
<strong>On-Behalf-Of: [username]</strong>
</pre>
</div>

<p>
When a server that supports mediated deposit receives an <span class="code_inline">On-Behalf-Of header</span> [<a href="#sword001">SWORD001</a>], the returned Service Document SHOULD identify only those collections to which the combination of mediated user and authenticated user might successfully deposit. If the target server does not support mediated deposit, the returned Service Document SHOULD contain a <span class="code_inline">sword:mediation</span> [<a href="#sword002">SWORD002</a>] extension element with a value of <span class="code_inline">false</span>.
</p>

<p>
The service document supplied in response MUST meet the following criteria in addition to those specified in [<a href="#atompub">AtomPub</a>]:
</p>

<ul>
<li>The SWORD server MUST specify the <span class="code_inline">sword:version</span> element with a value of <span class="code_inline">2.0</span> [<a href="#sword003">SWORD003</a>]</li>
<li>The SWORD server MAY specify the <span class="code_inline">sword:maxUploadSize</span> (in kB) of content that can be uploaded in one request [<a href="sword003">SWORD003</a>]</li>
<li>The SWORD server MUST specify the <span class="code_inline">app:accept</span> element.  If the Collection can take any format content type, it should specify <span class="code_inline">*/*</span> as its value [<a href="#atompub">AtomPub</a>].  It MUST also specify an <span class="code_inline">app:accept</span> element with an <span class="code_inline">alternate</span> attribute set to <span class="code_inline">multipart-related</span> as required by [<a href="#atommultipart">AtomMultipart</a>]</li>
<li>The SWORD server MAY include <span class="code_inline">sword:collectionPolicy</span> [<a href="#sword003">SWORD003</a>]</li>
<li>The SWORD server SHOULD include a <span class="code_inline">sword:mediation</span> element with a value of <span class="code_inline">true</span> or <span class="code_inline">false</span> [<a href="#sword002">SWORD002</a>]</li>
<li>The SWORD server MAY include a <span class="code_inline">sword:treatment</span> element [<a href="#sword003">SWORD003</a>]</li>
<li>The SWORD server MAY include zero or more <span class="code_inline">sword:acceptPackaging</span> elements [<a href="#sword002">SWORD002</a>].  The value SHOULD be a URI for a known packaging format (where such URIs exist)</li>
<li>The SWORD server MAY include zero or more <span class="code_inline">sword:service</span> [<a href="#sword003">SWORD003</a>] elements containing references to nested service descriptions</li>
</ul>

<p>
Example:
</p>

<div class="code">
<pre>
HTTP 1.1  200 OK
Content-Type: text/xml

&lt;?xml version="1.0" ?&gt;
&lt;service xmlns:dcterms="http://purl.org/dc/terms/"
    xmlns:sword="http://purl.org/net/sword/terms/"
    xmlns:atom="http://www.w3.org/2005/Atom"
    xmlns="http://www.w3.org/2007/app"&gt;

    &lt;sword:version&gt;2.0&lt;/sword:version&gt;
    &lt;sword:maxUploadSize&gt;16777216&lt;/sword:maxUploadSize&gt;

    &lt;workspace&gt;
        &lt;atom:title&gt;Main Site&lt;/atom:title&gt;

        &lt;collection href="http://swordapp.org/col-uri/43"&gt;
            &lt;atom:title&gt;Collection 43&lt;/atom:title&gt;
            &lt;accept&gt;*/*&lt;/accept&gt;
            &lt;accept alternate="multipart-related"&gt;*/*&lt;/accept&gt;
            &lt;sword:collectionPolicy&gt;Collection Policy&lt;/sword:collectionPolicy&gt;
            &lt;dcterms:abstract&gt;Collection Description&lt;/dcterms:abstract&gt;
            &lt;sword:mediation&gt;false&lt;/sword:mediation&gt;
            &lt;sword:treatment&gt;Treatment description&lt;/sword:treatment&gt;
            &lt;sword:acceptPackaging&gt;http://purl.org/net/sword/package/default&lt;/sword:acceptPackaging&gt;
            &lt;sword:acceptPackaging&gt;http://purl.org/net/sword/package/METSDSpaceSIP&lt;/sword:acceptPackaging&gt;
            &lt;sword:service&gt;http://swordapp.org/sd-uri/e4&lt;/sword:service&gt;
        &lt;/collection&gt;
    &lt;/workspace&gt;
&lt;/service&gt;

</pre>
</div>

<p>
The following requirements are placed on the client in receipt of a service document:
</p>

<ul>
<li>If no <span class="code_inline">sword:maxUploadSize</span> is specified, the client MUST assume that no size limit exists, but this specification RECOMMENDS that clients limit themselves to reasonably small file sizes unless special arrangements with the server have been made.</li>
<li>If no <span class="code_inline">sword:mediation</span> element is specified, the client MUST assume a value of <span class="code_inline">false</span>.
<li>If no <span class="code_inline">sword:acceptPackaging</span> element is specified, the client MUST assume that the server will only support the SWORD default packaging format (see <a href="#uris">Section 5: URIs</a> and <a href="#packaging">Section 7: Packaging</a> for more details).</li>
<li>The client MUST assume that the server supports the SWORD default packaging format (see <a href="#uris">Section 5: URIs</a> and <a href="#packaging">Section 7: Packaging</a> for more details), irrespective of whether it is listed in the <span class="code_inline">sword:acceptPackaging</span> elements</li>
<li>The client SHOULD NOT attempt to deposit files with a packaging format that is not in the <span class="code_inline">sword:acceptPackaging</span> elements, although the client MAY specify the default or binary package formats (see <a href="#uris">Section 5: URIs</a> and <a href="#packaging">Section 7: Packaging</a> for more details) in order to deposit opaquely packaged content</li>
</ul>

<h3><a name="protocoloperations_listingcollections">6.2 Listing Collections</a></h3>

<em>See Section 5.2 of [<a href="#atompub">AtomPub</a>] for details.</em>

<p>
AtomPub states that Collection Resources MUST provide representations in the form of Atom Feed Documents. Under the SWORD profile, implementations SHOULD provide such representations. Clients MUST NOT require a Collection Feed Document for deposit operation.
</p>

<h3><a name="protocoloperations_creatingresource">6.3. Creating a Resource</a></h3>

<h4><a name="protocoloperations_creatingresource_binary">6.3.1. Creating a Resource with a Binary File Deposit</a></h4>

<em>See Sections 5.3 and 9.2 of [<a href="#atompub">AtomPub</a>] for details.</em>

<p>
The client can create a resource by POSTing the binary content as the body of an HTTP request, with the <span class="code_inline">Content-Type</span>, <span class="code_inline">Content-Disposition</span>, and <span class="code_inline">Packaging</span> headers, with the following requirements:
</p>

<ul>
<li>The client SHOULD supply a <span class="code_inline">Content-Type</span> header</li>
<li>The client MUST supply a <span class="code_inline">Content-Disposition</span> header with a <span class="code_inline">filename</span> parameter</li>
<li>The client SHOULD supply a <span class="code_inline">Content-MD5</span> header with the MD5 checksum hex encoded for the binary content</li>
<li>The client SHOULD supply a <span class="code_inline">Packaging</span> header [<a href="#sword001">SWORD001</a>] providing the URI (or other allowed) of the packaging format used.  See <a href="#packaging">Section 7: Packaging</a> for more details.</li>
<li>The client MAY provide an <span class="code_inline">In-Progress</span> header with a value of <span class="code_inline">true</span> or <span class="code_inline">false</span> [<a href="#sword001">SWORD001</a>].  See <a href="#continueddeposit">Section 10: Continued Deposit</a> for more details.</li>
<li>The client MAY provide an <span class="code_inline">On-Behalf-Of</span> header [<a href="#sword001">SWORD001</a>].  See <a href="#authenticationmediateddeposit">Section 8: Authentication and Mediated Deposit</a> for more details.</li>
<li>The client MAY provide a <span class="code_inline">Suppress-Metadata</span> header [<a href="#sword001">SWORD001</a>].  See <a href="#metadatahandling">Section 9: Metadata Handling</a> for more details.</li>
<li>The client MAY supply a <span class="code_inline">Slug</span> header providing a suggested identifier for the deposited content</li>
</ul>

<div class="code">
<pre>
POST col-uri/43 HTTP/1.1
Host: example.org
Authorization: Basic ZGFmZnk6c2VjZXJldA==
Content-Type: application/zip
Content-Length: [content length]
Content-MD5: [md5-digest]
Content-Disposition: attachment; filename=[filename]
Packaging: http://purl.org/net/sword/package/METSDSpaceSIP
In-Progress: true
On-Behalf-Of: jbloggs
Suppress-Metadata: true
Slug: [suggested identifier]

[request entity]
</pre>
</div>

<p>
The requirements placed on the server here are:
</p>

<ul>
<li>If no <span class="code_inline">Content-Type</span> header is supplied the server MUST behave as per Section 7.2.1 in [<a href="#rfc2616">RFC2616</a>]</li>
<li>The server SHOULD verify the <span class="code_inline">Content-MD5</span> header against the content.  If the check fails, the server MUST respond with 412 Precondition Failed.  See <a href="errordocuments">Section 13: Error Documents</a>.</li>
<li>Server implementations MUST adopt the behaviour and requirements in [<a href="#rfc2183">RFC2183</a>] with respect to the <span class="code_inline">Content-Disposition</span> header.</li>
<li>If there is no <span class="code_inline">Packaging</span> header, the server MUST assume that it is the default packaging format
<li>Server implementations MUST adopt the behaviour and requirements in Section 9.7 of [<a href="#atompub">AtomPub</a>] with respect to the <span class="code_inline">Slug</span> header.</li>
<li>If there is no <span class="code_inline">In-Progress</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#continueddeposit">Section 10: Continued Deposit</a></li>
<li>The server MUST carry out authentication and mediated deposit as described in <a href="#authenticationmediateddeposit">Section 8: Authentication and Mediated Deposit</a></li>
<li>If there is no <span class="code_inline">Suppress-Metadata</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#metadatahandling">Section 9: Metadata Handling</a></li>
<li>The server MUST create a new resource containing content equivalent to or derived from the deposited content, or return an error document.</li>
</ul>

<p>
Once the server has processed the request it SHOULD return a Deposit Receipt as described in <a href="#depositreceipt">Section 11: Deposit Receipt</a> with the HTTP status code <span class="code_inline">201 (Created)</span> if the server has completed the deposit of the resource or <span class="code_inline">202 (Accepted)</span> if the server has accepted the resource but still has deposit workflows to run before finally accepting it.  The Deposit Receipt MUST be available under the <strong>Edit-URI</strong> (Member Entry URI), as supplied in the <span class="code_inline">Location</span> header.
</p>

<p>
For example:
</p>

<div class="code">
<pre>
201 Created
Location: [Edit-URI]

[optional Deposit Receipt]
</pre>
</div>


<h4><a name="protocoloperations_creatingresource_multipart">6.3.2. Creating a Resource with a Multipart Deposit</a></h4>

<em>See [<a href="#atommultipart">AtomMultipart</a>] for details.</em>

<p>
In order to ensure that all SWORD clients and servers can exchange a full range of file content and metadata, the use of Atom Multipart [<a href="#atommultipart">AtomMultipart</a>] is permitted to combine a default package with a set of Dublin Core metadata terms [<a href="#dublincore">DublinCore</a>] embedded in an Atom Entry.
</p>

<p>
The client can create a resource by POSTing a multipart mime message to the server with two parts: An Atom Entry containing the metadata for the deposit (known as the <strong>Entry Part</strong>), and the binary content as the second part (known as the <strong>Media Part</strong>), with the following requirements:
</p>

<ul>
<li>The client MUST comply with the rules laid out in [<a href="#atommultipart">AtomMultipart</a>]</li>
<li>The client MUST supply a <span class="code_inline">Content-Disposition</span> header of type <span class="code_inline">attachment"</span> on the Entry Part with a <span class="code_inline">name</span> parameter set to <span class="code_inline">atom</span> [<a href="#sword004">SWORD004</a>]</li>
<li>The client MUST supply a <span class="code_inline">Content-Disposition</span> header of type <span class="code_inline">attachment</span> on the Media Part with a <span class="code_inline">name</span> parameter set to <span class="code_inline">payload</span> and a <span class="code_inline">filename</span> parameter [<a href="#sword004">SWORD004</a>]</li>
<li>The client SHOULD supply a <span class="code_inline">Content-MD5</span> header with the MD5 checksum hex encoded for the binary content on the Media Part</span>
<li>The client SHOULD supply a <span class="code_inline">Packaging</span> header [<a href="#sword001">SWORD001</a>] providing the URI (or other allowed) of the packaging format used on the Media Part</li>
<li>The client MAY provide an <span class="code_inline">In-Progress</span> header with a value of <span class="code_inline">true</span> or <span class="code_inline">false</span> [<a href="#sword001">SWORD001</a>] on the main HTTP header</li>
<li>The client MAY provide an <span class="code_inline">On-Behalf-Of</span> header [<a href="#sword001">SWORD001</a>] on the main HTTP header</li>
<li>The client MAY provide a <span class="code_inline">Suppress-Metadata</span> header [<a href="#sword001">SWORD001</a>] on the main HTTP header</li>
<li>The client MAY supply a <span class="code_inline">Slug</span> header providing a suggested identifier for the deposited content on the main HTTP header</li>
<li>The client SHOULD add Dublin Core [<a href="#dublincore">DublinCore</a>] terms to the Atom Entry as foreign markup (if appropriate); the terms MUST be embedded as direct children of the <span class="code_inline">atom:entry</span> element, if present.</li>
<li>The client MAY add any other metadata formats or foreign markup to the <span class="code_inline">atom:entry</span> element</li>
</ul>

<p>
For example:
</p>

<div class="code">
<pre>
POST col-uri/43 HTTP/1.1
Host: example.org
Authorization: Basic ZGFmZnk6c2VjZXJldA==
Content-Length: [content length]
Content-Type: multipart/related;
            boundary="===============1605871705==";
            type="application/atom+xml"
In-Progress: true
On-Behalf-Of: jbloggs
Suppress-Metadata: true
Slug: [suggested identifier]
MIME-Version: 1.0

Media Post
--===============1605871705==
Content-Type: application/atom+xml; charset="utf-8"
Content-Disposition: attachment; name="atom"
MIME-Version: 1.0

&lt;?xml version="1.0"?&gt;
&lt;entry xmlns="http://www.w3.org/2005/Atom"
        xmlns:dcterms="http://purl.org/dc/terms/"&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;id&gt;urn:uuid:1225c695-cfb8-4ebb-aaaa-80da344efa6a&lt;/id&gt;
    &lt;updated&gt;2005-10-07T17:17:08Z&lt;/updated&gt;
    &lt;author&gt;&lt;name&gt;Contributor&lt;/name&gt;&lt;/author&gt;
    &lt;summary type="text"&gt;The abstract&lt;/summary&gt;

    &lt;!-- some embedded metadata --&gt;
    &lt;dcterms:abstract&gt;The abstract&lt;/dcterms:abstract&gt;
    &lt;dcterms:accessRights&gt;Access Rights&lt;/dcterms:accessRights&gt;
    &lt;dcterms:alternative&gt;Alternative Title&lt;/dcterms:alternative&gt;
    &lt;dcterms:available&gt;Date Available&lt;/dcterms:available&gt;
    &lt;dcterms:bibliographicCitation&gt;Bibliographic Citation&lt;/dcterms:bibliographicCitation&gt;
    &lt;dcterms:contributor&gt;Contributor&lt;/dcterms:contributor&gt;
    &lt;dcterms:description&gt;Description&lt;/dcterms:description&gt;
    &lt;dcterms:hasPart&gt;Has Part&lt;/dcterms:hasPart&gt;
    &lt;dcterms:hasVersion&gt;Has Version&lt;/dcterms:hasVersion&gt;
    &lt;dcterms:identifier&gt;Identifier&lt;/dcterms:identifier&gt;
    &lt;dcterms:isPartOf&gt;Is Part Of&lt;/dcterms:isPartOf&gt;
    &lt;dcterms:publisher&gt;Publisher&lt;/dcterms:publisher&gt;
    &lt;dcterms:references&gt;References&lt;/dcterms:references&gt;
    &lt;dcterms:rightsHolder&gt;Rights Holder&lt;/dcterms:rightsHolder&gt;
    &lt;dcterms:source&gt;Source&lt;/dcterms:source&gt;
    &lt;dcterms:title&gt;Title&lt;/dcterms:title&gt;
    &lt;dcterms:type&gt;Type&lt;/dcterms:type&gt;

&lt;/entry&gt;
--===============1605871705==
Content-Type: application/zip
Content-Disposition: attachment; name=payload; filename=[filename]
Packaging: http://purl.org/net/sword/package/default
Content-MD5: [md5-digest]
MIME-Version: 1.0

[...binary package data...]
--===============1605871705==--
</pre>
</div>

<p>
The requirements placed on the server here are:
</p>

<ul>
<li>The server SHOULD verify the <span class="code_inline">Content-MD5</span> header against the Media Part.  If the check fails, the server MUST respond with 412 Precondition Failed.  See <a href="#errordocuments">Section 13: Error Documents</a>.</li>
<li>Server implementations MUST adopt the behaviour and requirements in [<a href="#rfc2183">RFC2183</a>] with respect to the <span class="code_inline">Content-Disposition</span> header for the Media Part</li>
<li>If there is no <span class="code_inline">Packaging</span> header on the Media Part, the server MUST assume that it is the default packaging format</li>
<li>Server implementations MUST adopt the behaviour and requirements in Section 9.7 of [<a href="#atompub">AtomPub</a>] with respect to the <span class="code_inline">Slug</span> header</li>
<li>If there is no <span class="code_inline">In-Progress</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#continueddeposit">Section 10: Continued Deposit</a></li>
<li>If there is an <span class="code_inline">On-Behalf-Of</span> header, the server MUST behave as described in <a href="#authenticationmediateddeposit">Section 8: Authentication and Mediated Deposit</a></li>
<li>If there is no <span class="code_inline">Suppress-Metadata</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#metadatahandling">Section 9: Metadata Handling</a></li>
<li>The server MUST create a new resource containing content equivalent to or derived from the deposited content, or return an error document.</li>
<li>The server MUST be able to record and later reflect the Dublin Core [<a href="#dublincore">DublinCore</a>] foreign markup in the <span class="code_inline">atom:entry</span> element, but MAY NOT understand any other embedded formats.</li>
</ul>

<p>
Once the server has processed the request it SHOULD return a Deposit Receipt as described in <a href="#depositreceipt">Section 11: Deposit Receipt</a> with the HTTP status code <span class="code_inline">201 (Created)</span> if the server has completed the deposit of the resource or <span class="code_inline">202 (Accepted)</span> if the server has accepted the resource but still has deposit workflows to run before finally accepting it.  The Deposit Receipt MUST be available under the <strong>Edit-URI</strong> (Member Entry URI), as supplied in the <span class="code_inline">Location</span> header.
</p>

<p>
For example:
</p>

<div class="code">
<pre>
201 Created
Location: [Edit-URI]

[optional Deposit Receipt]
</pre>
</div>

<h3><a name="protocoloperations_retrievingcontent">6.4. Retrieving the content</a></h3>

<em>See section 5.4 of [<a href="#atompub">AtomPub</a>] for details.</em>

<p>
The Deposit Receipt contains two URIs which can be used to retrieve content from the server: <strong>Cont-URI</strong> and <strong>EM-URI</strong>.  These are provided in the <span class="code_inline">atom:content@src</span> element and the <span class="code_inline">atom:link@rel="edit-media"</span> elements respectively.  Their only functional difference is that the client MUST NOT carry out any HTTP operations other than GET on the <strong>Cont-URI</strong>, while all operations are permitted on the <strong>EM-URI</strong>.  It is acceptable, but not required, that both URIs to be the same, and in this section we refer only to the <strong>EM-URI</strong> but in all cases it can be substituted for the <strong>Cont-URI</strong>.
</p>

<p>
The Deposit Receipt contains zero or more <span class="code_inline">sword:packaging</span> elements [<a href="#sword002">SWORD002</a>], indicating to the client what package formats can be retrieved from the server.  For example:
</p>

<div class="code">
<pre>
&lt;entry xmlns="http://www.w3.org/2005/Atom"
        xmlns:sword="http://purl.org/net/sword/"&gt;

    [...]

    &lt;content type="application/zip" src="http://swordapp.org/cont-uri/43/my_deposit"/&gt;
    &lt;link rel="edit-media" href="http://swordapp.org/em-uri/43/my_deposit"/&gt;

    &lt;sword:packaging&gt;http://purl.org/net/sword/package/default&lt;/sword:packaging&gt;
    &lt;sword:packaging&gt;http://purl.org/net/sword/package/METSDSpaceSIP&lt;/sword:packaging&gt;
    &lt;sword:packaging&gt;http://purl.org/net/sword/package/BagIt&lt;/sword:packaging&gt;
        
&lt;/entry&gt;
</pre>
</div>

<p>
To retrieve the content in the desired packaging format, the client makes an HTTP GET request to the <strong>EM-URI</strong> and MAY supply an <span class="code_inline">Accept-Packaging</span> header [<a href="#sword001">SWORD001</a>] with the URI from one of the <span class="code_inline">sword:packaging</span> elements.
</p>

<p>
The server will respond in different ways depending on a number of conditions:
</p>

<ol>
<li>If the <span class="code_inline">Accept-Packaging</span> header is not supplied, the server SHOULD assume the default packaging format, but MAY elect another format if it wishes.  The server MUST then supply the client with a package which meets these specifications.</li>
<li>If the <span class="code_inline">Accept-Packaging</span> header is supplied, and contains the URI (or other allowed value) of a format that the server supports, the server MUST then supply the client with a package which meets these specifications.</li>
<li>If the <span class="code_inline">Accept-Packaging</span> header is supplied but contains a URI (or other allowed value) for a format that the server does not support, the server MUST respond with 406 Not Acceptable and MAY include an error document as per <a href="#errordocuments">Section 13: Error Documents</a>.</li>
</ol>

<p>
For more details about the packaging process, see <a href="#packaging">Section 7: Packaging</a>
</p>

<h3><a name="protocoloperations_editingcontent">6.4. Editing the Content of a Resource</a></h3>

<em>See section 5.4 and 9.3 of [<a href="#atompub">AtomPub</a>] for details.</em>

<p>
The client can replace the existing content of a resource by performing an HTTP PUT of some new binary content to the <strong>EM-URI</strong>, with the following requirements:
</p>

<ul>
<li>The client SHOULD supply a <span class="code_inline">Content-Type</span> header</li>
<li>The client MUST supply a <span class="code_inline">Content-Disposition</span> header with a <span class="code_inline">filename</span> parameter</li>
<li>The client SHOULD supply a <span class="code_inline">Content-MD5</span> header with the MD5 checksum hex encoded for the binary content</li>
<li>The client SHOULD supply a <span class="code_inline">Packaging</span> header [<a href="#sword001">SWORD001</a>] providing the URI (or other allowed) of the packaging format used</li>
<li>The client MAY provide an <span class="code_inline">In-Progress</span> header with a value of <span class="code_inline">true</span> or <span class="code_inline">false</span> [<a href="#sword001">SWORD001</a>]</li>
<li>The client MAY provide an <span class="code_inline">On-Behalf-Of</span> header [<a href="#sword001">SWORD001</a>]</li>
<li>The client MAY provide a <span class="code_inline">Suppress-Metadata</span> header [<a href="#sword001">SWORD001</a>]</li>
</ul>

<p>
For example:
</p>

<div class="code">
<pre>
POST em-uri/43/my_deposit HTTP/1.1
Host: example.org
Content-Type: application/zip
Authorization: Basic ZGFmZnk6c2VjZXJldA==
Content-Length: [content length]
Content-MD5: [md5-digest]
Content-Disposition: attachment; filename=[filename]
Packaging: http://purl.org/net/sword/package/METSDSpaceSIP
In-Progress: true
On-Behalf-Of: jbloggs
Suppress-Metadata: true

[request entity]
</pre>
</div>

<p>
The requirements placed on the server here are:
</p>

<ul>
<li>The server SHOULD verify the <span class="code_inline">Content-MD5</span> header against the content.  If the check fails, the server MUST respond with 412 Precondition Failed.  See <a href="#errordocuments">Section 13: Error Documents</a>.</li>
<li>Server implementations MUST adopt the behaviour and requirements in [<a href="#rfc2183">RFC2183</a>] with respect to the <span class="code_inline">Content-Disposition</span> header</li>
<li>If there is no <span class="code_inline">Packaging</span> header, the server MUST assume that it is the default packaging format
<li>If there is no <span class="code_inline">In-Progress</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#continueddeposit">Section 10: Continued Deposit</a>.</li>
<li>If there is an <span class="code_inline">On-Behalf-Of</span> header, the server MUST behave as described in <a href="#authenticationmediateddeposit">Section 8: Authentication and Mediated Deposit</span>.</li>
<li>If there is no <span class="code_inline">Suppress-Metadata</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#metadatahandling">Section 9: Metadata Handling</a>.</li>
<li>The server MUST effectively replace all the existing content in the item (subject to the rules associated with Metadata Handling), although implementations may choose to provide versioning or some other mechanism for retaining the overwritten content.</li>
</ul>

<p>
Once the server has processed the request it SHOULD return a Deposit Receipt as described in <a href="#depositreceipt">Section 11: Deposit Receipt</a> with the HTTP status code <span class="code_inline">200 (OK)</span> if the server has completed the deposit of the resource or <span class="code_inline">202 (Accepted)</span> if the server has accepted the resource but still has deposit workflows to run before finally accepting it.  The Deposit Receipt MUST be available under the <strong>Edit-URI</strong> (Member Entry URI), which the server MAY supply in the <span class="code_inline">Location</span> header.
</p>

<p>
For example:
</p>

<div class="code">
<pre>
200 OK
Location: [Edit-URI]

[optional Deposit Receipt]
</pre>
</div>

<h3><a name="protocoloperations_deletingcontent">6.5. Deleting the Content of a Resource</a></h3>

<em>See Sections 5.4 and 9.4 of [<a href="#atompub">AtomPub</a>] for details.</em>

<p>
The client can remove all the content of a resource without removing the resource itself by issuing an HTTP DELETE request on the <strong>EM-URI</strong>, with the following requirements:
</p>

<ul>
<li>The client MAY provide an <span class="code_inline">In-Progress</span> header with a value of <span class="code_inline">true</span> or <span class="code_inline">false</span> [<a href="#sword001">SWORD001</a>]</li>
<li>The client MAY provide an <span class="code_inline">On-Behalf-Of</span> header [<a href="#sword001">SWORD001</a>]</li>
<li>The client MAY provide a <span class="code_inline">Suppress-Metadata</span> header [<a href="#sword001">SWORD001</a>]</li>
</ul>

<p>
For example:
</p>

<div class="code">
<pre>
DELETE em-uri/43/my_deposit HTTP/1.1
Host: example.org
Authorization: Basic ZGFmZnk6c2VjZXJldA==
In-Progress: true
On-Behalf-Of: jbloggs
Suppress-Metadata: true
</pre>
</div>

<p>
The requirements placed on the server here are:
</p>

<ul>
<li>If there is no <span class="code_inline">In-Progress</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#continueddeposit">Section 10: Continued Deposit</a>.</li>
<li>If there is an <span class="code_inline">On-Behalf-Of</span> header, the server MUST behave as described in <a href="#authenticationmediateddeposit">Section 8: Authentication and Mediated Deposit</a>.</li>
<li>If there is no <span class="code_inline">Suppress-Metadata</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#metadatahandling">Section 9: Metadata Handling</a>.</li>
<li>The server MUST effectively delete all the existing content in the item (subject to the rules associated with Metadata Handling), although implementations may choose to provide versioning or some other mechanism for retaining the deleted content.</li>
</ul>

<p>
Once the server has processed the request it SHOULD return a Deposit Receipt as described in <a href="#depositreceipt">Section 11: Deposit Receipt</a> with the HTTP status code <span class="code_inline">200 (OK)</span> if the server has completed the delete of the content or <span class="code_inline">202 (Accepted)</span> if the server has accepted the delete request but still has deposit workflows to run before finally accepting it.  The Deposit Receipt MUST be available under the <strong>Edit-URI</strong> (Member Entry URI), which the server MAY supply in the <span class="code_inline">Location</span> header.
</p>

<p>
For example:
</p>

<div class="code">
<pre>
200 OK
Location: [Edit-URI]

[optional Deposit Receipt]
</pre>
</div>

<h3><a name="protocoloperations_addingcontent">6.6. Adding Content to a Resource</a></h3>

<h4><a name="protocoloperations_addingcontent_binary">6.6.1. Adding New Packages or Files to a Container</a></h4>

<p>
The client can add further packaged or binary content to a container, adding to existing content rather than overwriting, by issuing an HTTP POST to the <strong>Edit-URI</strong>, with the following requirements:
</p>

<ul>
<li>The client SHOULD supply a <span class="code_inline">Content-Type</span> header</li>
<li>The client MUST supply a <span class="code_inline">Content-Disposition</span> header with a <span class="code_inline">filename</span> parameter</li>
<li>The client SHOULD supply a <span class="code_inline">Content-MD5</span> header with the MD5 checksum hex encoded for the binary content</li>
<li>The client SHOULD supply a <span class="code_inline">Packaging</span> header [<a href="#sword001">SWORD001</a>] providing the URI (or other allowed) of the packaging format used</li>
<li>The client MAY provide an <span class="code_inline">In-Progress</span> header with a value of <span class="code_inline">true</span> or <span class="code_inline">false</span> [<a href="#sword001">SWORD001</a>]</li>
<li>The client MAY provide an <span class="code_inline">On-Behalf-Of</span> header [<a href="#sword001">SWORD001</a>]</li>
<li>The client MAY provide a <span class="code_inline">Suppress-Metadata</span> header [<a href="#sword001">SWORD001</a>]</li>
</ul>

<div class="code">
<pre>
POST em-uri/43/my_deposit HTTP/1.1
Host: example.org
Content-Type: application/zip
Authorization: Basic ZGFmZnk6c2VjZXJldA==
Content-Length: [content length]
Content-MD5: [md5-digest]
Content-Disposition: attachment; filename=[filename]
Packaging: http://purl.org/net/sword/package/METSDSpaceSIP
In-Progress: true
On-Behalf-Of: jbloggs
Suppress-Metadata: true

[request entity]
</pre>
</div>

<p>
The requirements placed on the server here are:
</p>

<ul>
<li>The server SHOULD verify the <span class="code_inline">Content-MD5</span> header against the content.  If the check fails, the server MUST respond with 412 Precondition Failed.  See <a href="#errordocuments">Section 13: Error Documents</a>.</li>
<li>Server implementations MUST adopt the behaviour and requirements in [<a href="#rfc2183">RFC2183</a>] with respect to the <span class="code_inline">Content-Disposition</span> header</li>
<li>If there is no <span class="code_inline">Packaging</span> header, the server MUST assume that it is the default packaging format</li>
<li>If there is no <span class="code_inline">In-Progress</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#continueddeposit">Section 10: Continued Deposit</a>.</li>
<li>If there is an <span class="code_inline">On-Behalf-Of</span> header, the server MUST behave as described in <a href="authenticationmediateddeposit">Section 8: Authentication and Mediated Deposit</a>.</li>
<li>If there is no <span class="code_inline">Suppress-Metadata</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#metadatahandling">Section 9: Metadata Handling</a>.</li>
<li>The server SHOULD NOT overwrite any existing content, and MUST add content equivalent to or derived from the deposited content to the existing container or respond with an error document.</li>
</ul>

<p>
Once the server has processed the request it SHOULD return a Deposit Receipt as described in <a href="#depositreceipt">Section 11: Deposit Receipt</a> with the HTTP status code <span class="code_inline">200 (OK)</span> if the server has completed the deposit of the resource or <span class="code_inline">202 (Accepted)</span> if the server has accepted the resource but still has deposit workflows to run before finally accepting it.  The Deposit Receipt MUST be available under the <strong>Edit-URI</strong> (Member Entry URI), which the server MAY supply in the <span class="code_inline">Location</span> header.
</p>

<p>
For example:
</p>

<div class="code">
<pre>
200 OK
Location: [Edit-URI]

[optional Deposit Receipt]
</pre>
</div>

<h4><a name="protocoloperations_addingcontent_metadata">6.6.2. Adding New Metadata to a Resource</a></h4>

<p>
The client can update the metadata attached to a resource by issuing an HTTP POST of a new Atom Entry document containing metadata embedded as foreign markup, with the following requirements:
</p>

<ul>
<li>The client MUST supply a <span class="code_inline">Content-Type</span> header with the value <span class="code_inline">application/atom+xml</span> or <span class="code_inline">application/atom+xml;type=entry</span></li>
<li>The client MAY provide an <span class="code_inline">In-Progress</span> header with a value of <span class="code_inline">true</span> or <span class="code_inline">false</span> [<a href="#sword001">SWORD001</a>]</li>
<li>The client MAY provide an <span class="code_inline">On-Behalf-Of</span> header [<a href="#sword001">SWORD001</a>].</li>
<li>The client MAY provide a <span class="code_inline">Suppress-Metadata</span> header [<a href="#sword001">SWORD001</a>].</li>
<li>The client MAY add Dublin Core [<a href="#dublincore">DublinCore</a>] terms to the Entry as foreign markup; the terms MUST be embedded as direct children of the <span class="code_inline">atom:entry</span> element.</li>
<li>The client MAY add any other metadata format or foreign markup to the <span class="code_inline">atom:entry</span> element</li>
</ul>

<div class="code">
<pre>
POST /edit-uri/43/my_deposit HTTP/1.1
Host: example.org
Content-Type: application/atom+xml;type=entry
Authorization: Basic ZGFmZnk6c2VjZXJldA==
Content-Length: [content length]
In-Progress: true
On-Behalf-Of: jbloggs
Suppress-Metadata: true

[entry document]
</pre>
</div>

<p>
The requirements placed on the server here are:
</p>

<ul>
<li>If there is no <span class="code_inline">In-Progress</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#continueddeposit">Section 10: Continued Deposit</a>.</li>
<li>If there is an <span class="code_inline">On-Behalf-Of</span> header, the server MUST behave as described in <a href="#authenticationmediateddeposit">Section 8: Authentication and Mediated Deposit</a>.</li>
<li>If there is no <span class="code_inline">Suppress-Metadata</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#metadatahandling">Section 9: Metadata Handling</a>.</li>
<li>The server MUST be able to interpret and later reflect the Dublin Core [<a href="#dublincore">DublinCore</a>] foreign markup in the <span class="code_inline">atom:entry</span> element, but MAY NOT understand any other embedded formats, but MUST NOT generate an error on the presence of not-understood markup.</li>
<li>The server SHOULD only add metadata and not overwrite any existing metadata, but exact implementation will depend on the functions of the server.</li>
</ul>

<p>
Once the server has processed the request it SHOULD return a Deposit Receipt as described in <a href="#depositreceipt">Section 11: Deposit Receipt</a> with the HTTP status code <span class="code_inline">200 (OK)</span> if the server has completed the deposit of the resource or <span class="code_inline">202 (Accepted)</span> if the server has accepted the resource but still has deposit workflows to run before finally accepting it.  The Deposit Receipt MUST be available under the <strong>Edit-URI</strong> (Member Entry URI), which the server MAY supply in the <span class="code_inline">Location</span> header.
</p>

<p>
For example:
</p>

<div class="code">
<pre>
200 OK
Location: [Edit-URI]

[optional Deposit Receipt]
</pre>
</div>

<h4><a name="protocoloperations_addingcontent_multipart">6.6.3. Adding New Metadata and Packages or Files to a Resource with Multipart</a></h4>

<p>
The client can add new content and update the metadata attached to a resource by issuing an HTTP POST of an Atom Multipart [<a href="#atommultipart">AtomMultipart</a>] document, with the following requirements, to the <strong>EM-URI</strong>:
</p>

<ul>
<li>The client MUST comply with the rules laid out in [<a href="#atommultipart">AtomMultipart</a>]</li>
<li>The client MUST supply a <span class="code_inline">Content-Disposition</span> header of type <span class="code_inline">attachment</span> on the Entry Part with a <span class="code_inline">name</span> parameter set to <span class="code_inline">atom</span> [<a href="#sword004">SWORD004</a>]</li>
<li>The client MUST supply a <span class="code_inline">Content-Disposition</span> header of type <span class="code_inline">attachment</span> on the Media Part with a <span class="code_inline">name</span> parameter set to <span class="code_inline">payload</span> and a <span class="code_inline">filename</span> parameter [<a href="#sword004">SWORD004</a>]</li>
<li>The client SHOULD supply a <span class="code_inline">Content-MD5</span> header with the MD5 checksum hex encoded for the binary content on the Media Part</li>
<li>The client SHOULD supply a <span class="code_inline">Packaging</span> header [<a href="#sword001">SWORD001</a>] providing the URI (or other allowed) of the packaging format used on the Media Part</li>
<li>The client MAY provide an <span class="code_inline">In-Progress</span> header with a value of <span class="code_inline">true</span> or <span class="code_inline">false</span> [<a href="#sword001">SWORD001</a>] on the main HTTP header</li>
<li>The client MAY provide an <span class="code_inline">On-Behalf-Of</span> header [<a href="#sword001">SWORD001</a>] on the main HTTP header</li>
<li>The client MAY provide a <span class="code_inline">Suppress-Metadata</span> header [<a href="#sword001">SWORD001</a>] on the main HTTP header</li>
<li>The client MAY add Dublin Core [<a href="#dublinecore">DublinCore</a>] terms to the Entry as foreign markup; the terms MUST be embedded as direct children of the <span class="code_inline">atom:entry</span> element.</li>
<li>The client MAY add any other metadata format to the <span class="code_inline">atom:entry</span> element</li>
</ul>

<p>
For example:
</p>

<div class="code">
<pre>
POST /em-uri/43/my_deposit HTTP/1.1
Host: example.org
Authorization: Basic ZGFmZnk6c2VjZXJldA==
Content-Length: [content length]
Content-Type: multipart/related;
      boundary="===============1605871705==";
      type="application/atom+xml"
In-Progress: true
On-Behalf-Of: jbloggs
Suppress-Metadata: true
Slug: [suggested identifier]
MIME-Version: 1.0

Media Post

--===============1605871705==
Content-Type: application/atom+xml; charset="utf-8"
Content-Disposition: attachment; name="atom"
MIME-Version: 1.0

&lt;?xml version="1.0"?&gt;
&lt;entry xmlns="http://www.w3.org/2005/Atom"
        xmlns:dcterms="http://purl.org/dc/terms/"&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;id&gt;urn:uuid:1225c695-cfb8-4ebb-aaaa-80da344efa6a&lt;/id&gt;
    &lt;updated&gt;2005-10-07T17:17:08Z&lt;/updated&gt;
    &lt;author&gt;&lt;name&gt;Contributor&lt;/name&gt;&lt;/author&gt;
    &lt;summary type="text"&gt;The abstract&lt;/summary&gt;

    &lt;!-- some embedded metadata --&gt;
    &lt;dcterms:abstract&gt;The abstract&lt;/dcterms:abstract&gt;
    &lt;dcterms:accessRights&gt;Access Rights&lt;/dcterms:accessRights&gt;
    &lt;dcterms:alternative&gt;Alternative Title&lt;/dcterms:alternative&gt;
    &lt;dcterms:available&gt;Date Available&lt;/dcterms:available&gt;
    &lt;dcterms:bibliographicCitation&gt;Bibliographic Citation&lt;/dcterms:bibliographicCitation&gt;
    &lt;dcterms:contributor&gt;Contributor&lt;/dcterms:contributor&gt;
    &lt;dcterms:description&gt;Description&lt;/dcterms:description&gt;
    &lt;dcterms:hasPart&gt;Has Part&lt;/dcterms:hasPart&gt;
    &lt;dcterms:hasVersion&gt;Has Version&lt;/dcterms:hasVersion&gt;
    &lt;dcterms:identifier&gt;Identifier&lt;/dcterms:identifier&gt;
    &lt;dcterms:isPartOf&gt;Is Part Of&lt;/dcterms:isPartOf&gt;
    &lt;dcterms:publisher&gt;Publisher&lt;/dcterms:publisher&gt;
    &lt;dcterms:references&gt;References&lt;/dcterms:references&gt;
    &lt;dcterms:rightsHolder&gt;Rights Holder&lt;/dcterms:rightsHolder&gt;
    &lt;dcterms:source&gt;Source&lt;/dcterms:source&gt;
    &lt;dcterms:title&gt;Title&lt;/dcterms:title&gt;
    &lt;dcterms:type&gt;Type&lt;/dcterms:type&gt;

&lt;/entry&gt;
--===============1605871705==
Content-Type: application/zip
Content-Disposition: attachment; name=payload; filename=[filename]
Packaging: http://purl.org/net/sword/package/default
Content-MD5: [md5-digest]
MIME-Version: 1.0

...binary package data...
--===============1605871705==--
</pre>
</div>

<p>
The requirements placed on the server here are:
</p>

<ul>
<li>The server SHOULD verify the <span class="code_inline">Content-MD5</span> header against the Media Part.  If the check fails, the server MUST respond with 412 Precondition Failed.  See <a href="#errordocuments">Section 13: Error Documents</a>.</li>
<li>Server implementations MUST adopt the behaviour and requirements in [<a href="#rfc2183">RFC2183</a>] with respect to the <span class="code_inline">Content-Disposition</span> header for the Media Part.</li>
<li>If there is no <span class="code_inline">Packaging</span> header on the Media Part, the server MUST assume that it is the default packaging format</li>
<li>Server implementations MUST adopt the behaviour and requirements in Section 9.7 of [<a href="#atompub">AtomPub</a>] with respect to the <span class="code_inline">Slug</span> header</li>
<li>If there is no <span class="code_inline">In-Progress</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="continueddeposit">Section 10: Continued Deposit</a>.</li>
<li>If there is an <span class="code_inline">On-Behalf-Of</span> header, the server MUST behave as described in <a href="#authenticationmediateddeposit">Section 8: Authentication and Mediated Deposit</a>.</li>
<li>If there is no <span class="code_inline">Suppress-Metadata</span> header, the server MUST assume that it is <span class="code_inline">false</span>, and MUST behave as described in <a href="#metadatahandling">Section 9: Metadata Handling</a>.</li>
<li>The server MUST be able to interpret the Dublin Core [<a href="#dublincore">DublinCore</a>] foreign markup in the <span class="code_inline">atom:entry</span> element, but MAY NOT understand any other embedded formats, but MUST NOT generate an error on encountering not-understood foreign markup.</li>
</ul>

<p>
Once the server has processed the request it SHOULD return a Deposit Receipt as described in <a href="#depositreceipt">Section 11: Deposit Receipt</a> with the HTTP status code <span class="code_inline">201 (Created)</span> if the server has completed the deposit of the resource or <span class="code_inline">202 (Accepted)</span> if the server has accepted the resource but still has deposit workflows to run before finally accepting it.  The Deposit Receipt MUST be available under the <strong>Edit-URI</strong> (Member Entry URI), which the server MAY supply in the <span class="code_inline">Location</span> header.
</p>

<p>
For example:
</p>

<div class="code">
<pre>
201 Created
Location: [Edit-URI]

[optional Deposit Receipt]
<pre>
</div>

<h3><a name="protocoloperations_deleteconteiner">6.7. Delete the Container</a></h3>

<p>
The client can delete the entire object on the server by issuing an HTTP DELETE request on the <strong>Edit-URI</strong>, with the following requirements:
</p>

<ul>
<li>The client MAY provide an <span class="code_inline">On-Behalf-Of</span> header [<a href="#sword001">SWORD001</a>]</li>
</ul>

<div class="code">
<pre>
DELETE /edit-uri/43/my_deposit HTTP/1.1
Host: example.org
Authorization: Basic ZGFmZnk6c2VjZXJldA==
On-Behalf-Of: jbloggs
</pre>
</div>

<p>
The requirements placed on the server here are:
</p>

<ul>
<li>If there is an <span class="code_inline">On-Behalf-Of</span> header, the server MUST behave as described in <a href="authenticationmediateddeposit">Section 8: Authentication and Mediated Deposit</a>.</li>
<li>The server MUST effectively remove the Container and all its content, although implementations may choose to provide versioning or some other mechanism for retaining the deleted content.</li>
<li>The <strong>Edit-URI</strong> MUST return a 404 Not Found on any future requests.</li>
</ul>

<p>
Once the server has processed the request is MUST respond with an HTTP status code 204 (No Content) and leave the response body empty.
</p>

<h3><a name="protocoloperations_statement">6.8. Retrieving the Statement</a></h3>

<p>
The Statement can be found either embedded as foreign markup inside the Deposit Receipt, or can be retrieved by requesting the URI provided in the <span class="code_inline">atom:link@rel="http://purl.org/net/sword/terms/statement"</span> element.  The format of the statement is identified by the <span class="code_inline">type</span> attribute of the <span class="code_inline">atom:link@rel="http://purl.org/net/sword/terms/statement"</span> element and MUST be <span class="code_inline">application/rdf+xml</span> for an OAI-ORE Resource Map, or <span class="code_inline">application/atom+xml;type=feed</span> for an Atom Feed.
</p>

<p>
It MAY also be possible to content negotiate for the statement on the <strong>Edit-URI</strong>.  All negotiable formats MUST also be available as <span class="code_inline">atom:link</span> elements with <span class="code_inline">@rel="http://purl.org/net/sword/terms/statement"</span>.
</p>

<p>
For details on these serialisations see <a href="#statement">Section 12: SWORD Statement</a>.
</p>

<h2><a name="packaging">7. Packaging</a></h2>

<p>
AtomPub uses the MIME mechanism to describe the data encoding for resources. This mechanism is inadequate where compound types are involved, such as tar archive files, METS packages, SCORM packages, MPEG21 DIDL packages etc. For example, a server might support certain METS profiles but not others. Other servers might be agnostic towards packaging, but support only certain contents within an archive.
</p>

<p>
In order to support package deposit and retrieval, SWORD uses the mechanisms described in [<a href="#sword002">SWORD002</a>] to extend AtomPub.
</p>

<h3><a name="packaging_servicedescription">7.1. Package support in Service description</a></h3>

The SWORD Service Document uses the sword:acceptPackaging element from [SWORD002] to indicate that a SWORD collection will accept deposits of a particular packaging format.

Clients should refer to the sword:treatment description in the Service Document to find out the treatment for a particular packaging type.

Packages formats SHOULD be identified by a URI (as per [SWORD002]), and MAY be identified by a URI from the SWORD package registry (see [SWORD0005]).

<?xml version="1.0" encoding='utf-8'?>
<service xmlns="http://www.w3.org/2007/app"
         xmlns:atom="http://www.w3.org/2005/Atom"
	 xmlns:sword="http://purl.org/net/sword/"
	 xmlns:dcterms="http://purl.org/dc/terms/">

 <sword:version>2.0</sword:version>

 <workspace>
   <atom:title>Main Site</atom:title>
   <collection
       href="http://www.swordserver.org/atom/geography-collection" >
     <atom:title>My Repository : Geography Collection</atom:title>
     <accept>application/zip</accept>
     <sword:collectionPolicy>Collection Policy</sword:collectionPolicy>
     <dcterms:abstract>Collection description</dcterms:abstract>
     <sword:acceptPackaging>http://purl.org/net/sword/package/METSDSpaceSIP</sword:acceptPackaging>
     <sword:acceptPackaging>http://purl.org/net/sword/package/BagIt</sword:acceptPackaging>
   </collection>

 </workspace>
</service>

7.2 Package support during resource creation

When creating Media Resources, the client SHOULD indicate the archive file MIME type using the HTTP "Content-Type" header, and SHOULD also give information about content packaging using the Packaging HTTP header [SWORD001].

The value of the Packaging header SHOULD match one of values the server has advertised as acceptable for the collection in the manner described in Section 7.1.

If a server receives a POST with an unacceptable Packaging header value, it MUST reject the POST by returning an HTTP response with a status code of 415 (Unsupported Media Type), or store the content without further processing (as per [SWORD001]).

7.3 Package description in entry documents

When describing packaged resources in Media Entry documents, servers MUST use the atom:content@type attribute to describe the MIME type of the resource, and MAY add sword:packaging elements to the entry.

If the server does not supply any sword:packaging elements, the client MUST assume that the server only supports the default packaging format [SWORD005].

7.4 Example

  POST /geography-collection HTTP/1.1
  Host: example.org
  Content-Type: application/zip
  Authorization: Basic ZGFmZnk6c2VjZXJldA==
  Content-Length: nnn
  Content-MD5: [md5-digest]
  Content-Disposition: filename=myDSpaceMETSItem.zip
  Packaging: http://purl.org/net/sword/package/METSDSpaceSIP
  User-Agent: MyJavaClient/0.1 Restlet/2.0


  HTTP/1.1 201 Created
  Date: Mon, 18 August 2008 14:27:11 GMT
  Content-Length: nnn
  Content-Type: application/atom+xml; charset="utf-8"
  Location: http://www.swordserver.org/geography-collection/atom/my_deposit.atom

  <?xml version="1.0"?>

   <entry xmlns="http://www.w3.org/2005/Atom"
	 xmlns:sword="http://purl.org/net/sword/">
     <title>My Deposit</title>
     <id>info:something:1</id>

     <updated>2008-08-18T14:27:08Z</updated>
     <author><name>jbloggs</name></author>
     <summary type="text">A summary</summary
     <generator uri="http://www.swordserver.org/engine" version="1.0"/>

     <content type="application/zip"
        src="http://www.swordserver.org/geography-collection/deposit1.zip"/>
     <sword:packaging>http://purl.org/net/sword/package/METSDSpaceSIP</sword:packaging>
     <sword:packaging>http://purl.org/net/sword/package/BagIt</sword:packaging>
     <link rel="edit"
        href="http://www.swordserver.org/geography-collection/atom/my_deposit.atom" />
  </entry>

7.5 Registering packaging types under the sword namespace

Clients and servers SHOULD use URIs to communicate about package types, and MAY use URIs registered in the SWORD Package Registry [SWORD005].  To register a new URI in the SWORD Package Registry, follow the instructions laid out in [SWORD005].  Registration of package URIs in the SWORD Package Registry is strictly optional.

8. Authentication and Mediated Deposit

In [AtomPub] section 14, implementations MUST support HTTP Basic Authentication in conjunction with a TLS connection. The SWORD Profile relaxes this requirement: SWORD client and server implementations SHOULD be capable of being configured to use HTTP Basic Authentication [RFC2617] in conjunction with a TLS connection as specified by [RFC2818].

In a number of situations the authenticated user using a SWORD client is not the owner of the deposited resource. SWORD provides a way of representing this usage by allowing clients to set a HTTP header field On-Behalf-Of which, if present SHOULD contain a user principle for the owner of the resource. It is also possible to use this SWORD mediation mechanism for situations such as non-interactive batch deposit in which the authenticated user is a software acting on behalf of a user. 

The mediation technique described by SWORD is not intrinsically secure - it is assumed that trust between the owning user and the mediating user will be established by extending SWORD, or outside the scope of a resource creation, using a mechanism such as that described by [OAUTH].

8.1 Mediation In Service Description

SWORD servers SHOULD indicate whether they support mediated deposit by including a sword:mediation element containing a text element of either "true" or "false" in app:collection elements in Service Documents (see Section XXX).

Clients SHOULD use the On-Behalf-Of header when retrieving Service Documents if they intend to use the feature for resource creation. Servers MAY use this header information along with authentication and any other information in constructing the Service Document representation returned. For example, the server might include only collections to which the On-Behalf-Of can deposit.

    <?xml version="1.0" encoding='utf-8'?>
    <service xmlns="http://www.w3.org/2007/app"
             xmlns:atom="http://www.w3.org/2005/Atom"
         xmlns:sword="http://purl.org/net/sword/"
         xmlns:dcterms="http://purl.org/dc/terms/">

     <sword:version>2.0</sword:version>

     <workspace>

       <atom:title>Main Site</atom:title>
       <collection
           href="http://www.swordserver.org/atom/geography-collection" >
         <atom:title>My Repository : Geography Collection</atom:title>

         <accept>application/xml</accept>
         <accept>application/zip</accept>
         <accept>application/atom+xml</accept>

         <sword:collectionPolicy>Collection Policy</sword:collectionPolicy>
         <dcterms:abstract>Collection description</dcterms:abstract>

         <sword:mediation>true</sword:mediation>
         <sword:treatment>treatment description</sword:treatment>
         <sword:packaging>http://purl.org/net/sword/package/BagIt</sword:packaging>
       </collection>

     </workspace>
    </service>

8.2 Recording Depositing Users

In all cases (mediated or not) where a user has authenticated to make a deposit, servers SHOULD preserve the user's identity in the sword:depositedBy property of the SWORD Statement. In mediated deposit, the value given in the On-Behalf-Of header SHOULD be used for the value of the sword:depositedOnBehalfOf property of the SWORD Statement.


9. Metadata Handling

The Atom Publishing Protocol [AtomPub] has good default support for metadata and the packaging formats that are used to exchange data between scholarly systems often support rich metadata formats.  Therefore, handling metadata well is an important aspect to SWORD.

Requests that come into a SWORD server MAY contain a Suppress-Metadata HTTP header [SWORD001] which MUST contain one of the values "true" or "false".  If no header is provided the server MUST assume a value of "false" for the purposes of any internal processing.  The following two sections describe how the server should behave under the different conditions.

9.1 Handle Metadata Updates

If Suppress-Metadata is "false", then the server SHOULD consider the metadata supplied in the deposit for inclusion in its  metadata record for the object being deposited.  There are several conditions in which the server may find itself needing to look at the incoming metadata as a source for its records:

* The object is a new deposit: In this case the server MAY extract the metadata from the deposit and use it to populate a metadata record
* The object is being updated with new metadata and optionally content: the server MAY extract the metadata from the deposit and use it to extend and overwrite as it sees fit any existing metadata record
* The object is having its content deleted: the server MAY remove any metadata associated with the item, particularly if that metadata was originally obtained from some previously deposited package

9.2 Suppress Metadata Updates

If Suppress-Metadata is "true", then the server SHOULD consider that any metadata supplied in the deposit be ignored or at least not used in any way to overwrite existing metadata.  There are several conditions in which the server may find itself needing to suppress metadata hanlding:

* The object is a new deposit: In this case the server SHOULD NOT extract the metadata from the deposit and use it to populate a metadata record, but this does not preclude the server generating metadata from other sources or processes.
* The object is being updated with new content and optionally metadata: the server SHOULD NOT extract metadata from the deposit and use it to overwrite any existing metadata record.
* The object is having its content deleted: the server SHOULD NOT remove any metadata associated with the item, although the content itself is being removed.

10. Continued Deposit

As scholarly systems may wish to give the client more control over the publishing process, SWORD uses the In-Progress HTTP header [SWORD001] to allow the client to indicate that a deposit should not yet be injected into any post-submission or pre-publication workflow.  The In-Progress header MUST take the value "true" or "false", and if it is not present the  server MUST assume that it is "false" and behave as described below.

10.1 Deposit Complete

If In-Progress is "false", the server MUST assume that it can carry on processing the deposit or deletion as it sees fit.

10.2 Deposit Incomplete

If In-Progress is "true", the server SHOULD expect the client to provide further updates to the item some undetermined time in the future.  Details of how this is implemented is dependent on the server's purpose.  For example, a repository system may hold items which are marked In-Progress in a workspace until such time as a client request indicates that the deposit is complete.


11. Deposit Receipt

On successfully accepting a POST (deposit), implementers SHOULD return an Atom Entry Document with the HTTP response.  The Atom Entry Document is known in SWORD as the Deposit Receipt must conform to the following conditions:

* It MAY contain information about the metadata associated with the deposit as it is stored on the server.  If it does, it SHOULD provide this metadata in extended Dublin Core, although it MAY also provide it in other formats.  Any Dublin Core markup should be in Dublin Core XML and embedded directly in the atom:entry element, not in a dcterms:metadata element.
* It MUST contain a Media Entry URI (Edit-URI)
* It MUST contain a Media Resource URI (EM-URI)
* It MAY contain an arbitrary number of sword:packaging elements declaring the formats that the Media Resource can be retrieved in
* It MUST contain a single sword:treatment element which contains either a human-readable statement describing treatment the deposited resource has received or a URI that dereferences to such a description.
* It MAY contain a single sword:verboseDescription element which should contain a verbose description of the deposit process.  This MUST only be used for debugging and development purposes, and clients MUST NOT rely on this field to contain anything in particular.
* It MAY contain the SWORD Statement (see Section 12) embedded as foreign markup using its OAI-ORE serialisation (See Section 12.1)
* It MAY contain one or more atom:link element with the rel attribute of "http://purl.org/net/sword/terms/statement", and the href to a URI where the statement can be retrieved.  The atom:link element MUST contain a type attribute which indicates the mime-type of the statement (for example "application/atom+xml;type=feed" or "application/rdf+xml")
* It MUST contain either at least one atom:link@rel="http://purl.org/net/sword/terms/statement" or an embedded Statement document.
* It MAY contain an atom:link@rel="alternate" element with an href attribute which points to the splash page of the item on the server

11.1 Example

 <entry xmlns="http://www.w3.org/2005/Atom"
	 xmlns:sword="http://purl.org/net/sword/">
   
   <title>My Deposit</title>
   <id>info:something:1</id>
   <updated>2008-08-18T14:27:08Z</updated>
   <summary type="text">A summary</summary>
   <generator uri="http://www.myrepository.ac.uk/sword-plugin" version="1.0"/>

   <!-- the item's metadata -->
	<dcterms:abstract>The abstract</dcterms:abstract>
	<dcterms:accessRights>Access Rights</dcterms:accessRights>
	<dcterms:alternative>Alternative Title</dcterms:alternative>
	<dcterms:available>Date Available</dcterms:available>
	<dcterms:bibliographicCitation>Bibliographic Citation</dcterms:bibliographicCitation>
	<dcterms:contributor>Contributor</dcterms:contributor>
	<dcterms:description>Description</dcterms:description>
	<dcterms:hasPart>Has Part</dcterms:hasPart>
	<dcterms:hasVersion>Has Version</dcterms:hasVersion>
	<dcterms:identifier>Identifier</dcterms:identifier>
	<dcterms:isPartOf>Is Part Of</dcterms:isPartOf>
	<dcterms:publisher>Publisher</dcterms:publisher>
	<dcterms:references>References</dcterms:references>
	<dcterms:rightsHolder>Rights Holder</dcterms:rightsHolder>
	<dcterms:source>Source</dcterms:source>
	<dcterms:title>Title</dcterms:title>
	<dcterms:type>Type</dcterms:type>

   <sword:verboseDescription>
   	Does collection exist? True.
   	User authenticates? True.
   	User: jbloggs
   	User has rights to collection? True. 
   </sword:verboseDescription>
   <sword:treatment>Unpacked. JPEG contents converted to JPEG2000.</sword:treatment>

   <link rel="alternate" href="http://www.swordserver.ac.uk/col1/mydeposit.html"/>
   <content type="application/zip" src="http://www.swordserver.ac.uk/col1/mydeposit"/>
   <link rel="edit-media" href="http://www.swordserver.ac.uk/col1/mydeposit"/>
   <link rel="edit" href="http://www.swordserver.ac.uk/col1/mydeposit.atom" />
   <sword:packaging>http://purl.org/net/sword/package/BagIt</sword:packaging>

   <link rel="http://purl.org/net/sword/terms/statement" type="application/atom+xml;type=feed" href="http://www.swordserver.ac.uk/col1/mydeposit.feed"/>
   <link rel="http://purl.org/net/sword/terms/statement" type="application/rdf+xml" href="http://www.swordserver.ac.uk/col1/mydeposit.rdf"/>

   <rdf:RDF>
      <!-- OAI-ORE serialisation of Statement here -->
   </rdf:RDF>
   
</entry>

12. SWORD Statement

The Statement is a document or region of the Deposit Receipt which describes two features of the object as it appears on the server:

* Structure.  This may include originally uploaded content files, unpackaged content, derived content and any other features of the object
* State.  This allows the server to indicate to the client some information with regard to the state of the item on the server, including but not limited, to its ingest workflow position.

12.1 Predicates used by the Statement

All predicates used by the statement in any of its serialisations are defined here, and all exist under the sword namespace:

	http://purl.org/net/sword/terms/

12.1.1 sword:originalDeposit

URI: http://purl.org/net/sword/terms/originalDeposit

This is used to indicate the URI of a resource on the server which was an original deposit package.  This allows the client to easily identify any packages which form the basis of the original deposit among other parts of the object which may be derived from the original.

In XML this may be serialised as:

	<sword:originalDeposit href="http://location/of/deposit"/>

In RDF/XML this can be serialised as as:

	<sword:originalDepsit rdf:resource="http://location/of/deposit"/>

12.1.2 sword:state

URI: http://purl.org/net/sword/terms/state

This is used to supply the URI representing the state of an item on the server.  This can be any URI, and is not constrained to any ontology.  This can be used in combination with sword:stateDescription to provide more details to the client.

In XML this may be serialised as:

	<sword:state href="http://sword/state"/>

In RDF/XML this can be serialised as:

	<sword:state rdf:resource="http://sword/state" />


12.1.3 sword:packaging

URI: http://purl.org/net/sword/terms/packaging

This is used to identify the packaging format of a resource.  Particularly, if used in conjunction with sword:originalDeposit, this can be used to indicate the package format that an original deposit package used.

In XML this may be serialised as:

	<sword:originalDeposit href="http://location/of/deposit">
		<sword:packaging>http://sword/packaging/</sword:packaging>
	</sword:originalDeposit>

In RDF/XML this can be serialised as:

	<sword:originalDepsit rdf:resource="http://location/of/deposit"/>
	<rdf:Description rdf:about="http://location/of/deposit">
		<sword:packaging rdf:resource="http://sword/packaging/"/>
	</rdf:Description>


12.1.4 sword:depositedOn

URI: http://purl.org/net/sword/terms/depositedOn

This is used to provide a user who was responsible for depositing an original sword package.  The use credentials may just be the username of the depositor, but the server is free to add further details where necessary.

In XML this may be serialised as:

	<sword:originalDeposit href="http://location/of/deposit">
		<sword:depositedOn>2011-01-01T00:00:00Z</sword:depositedOn>
	</sword:originalDeposit>

In RDF/XML this may be serialised as

	<sword:originalDepsit rdf:resource="http://location/of/deposit"/>
	<rdf:Description rdf:about="http://location/of/deposit">
		<sword:depositedOn rdf:datatype="http://www.w3.org/2001/XMLSchema#dateTime">2011-01-01T00:00:00Z</sword:depositedOn>
	</rdf:Description>

12.1.5 sword:depositedBy

URI: http://purl.org/net/sword/terms/depositedBy

This is used to provide a user who was responsible for depositing an original sword package.  The use credentials may just be the username of the depositor, but the server is free to add further details where necessary.

In XML this may be serialised as:

	<sword:originalDeposit href="http://location/of/deposit">
		<sword:depositedBy>jbloggs</sword:depositedBy>
	</sword:originalDeposit>

In RDF/XML this may be serialised as

	<sword:originalDepsit rdf:resource="http://location/of/deposit"/>
	<rdf:Description rdf:about="http://location/of/deposit">
		<sword:depositedBy>jbloggs</sword:depositedBy>
	</rdf:Description>

12.1.6 sword:depositedOnBehalfOf

URI: http://purl.org/net/sword/terms/depositedOnBehalfOf

This is used to provide the user for whom the original sword package was deposited on behalf of.  The use credentials may just be the username of the depositor, but the server is free to add further details where necessary.

In XML this may be serialised as:

	<sword:originalDeposit href="http://location/of/deposit">
		<sword:depositedOnBehalfOf>jbloggs</sword:depositedOnBehalfOf>
	</sword:originalDeposit>

In RDF/XML this may be serialised as

	<sword:originalDepsit rdf:resource="http://location/of/deposit"/>
	<rdf:Description rdf:about="http://location/of/deposit">
		<sword:depositedOnBehalfOf>jbloggs</sword:depositedOnBehalfOf>
	</rdf:Description>


12.1.7 sword:stateDescription

URI: http://purl.org/net/sword/terms/stateDescription

This is used to provide a human readable description of the state that the item is in on the server.  This is used in conjunction with the sword:state to provide additional details for the client to use in its interface with the end user.

In XML this may be serialised as:

	<sword:state href="http://sword/state">
		<sword:stateDescription>The item has passed through the workflow and is now archived</sword:stateDescription>
	</sword:state>

In RDF/XML this may be serialised as

	<sword:state rdf:resource="http://sword/state"/>
	<rdf:Description rdf:about="http://sword/state">
		<sword:stateDescription>The item has passed through the workflow and is now archived</sword:stateDescription>
	</rdf:Description>


12.2 OAI-ORE Serialisation

The SWORD statement can be provided as an OAI-ORE Resource [OAIORE] Map with sword extensions.  For an RDF document to comply with the requirements of the SWORD statement it needs to meet the following requirements but is not constrained in any way as to what additional data is provided alongside.  As such, it is expected that the SWORD statement may be included with existing RDF serialisations of objects provided by the server.

The responsibilities of the server are:

* The aggregation SHOULD identify any original deposit packages with the sword:originalDeposit term
* The aggregation MAY specify a state for the item on the server with the sword:state term
* If present, the sword:state term SHOULD include a human readable description in the sword:stateDescription term
* If present, the sword:originalDeposit term MAY include one or more sword:packaging terms
* If present, the sword:originalDeposit term MAY include the date the package was originally deposited in the sword:depositedOn term
* If present, the sword:originalDeposit term MAY include the depositor of the package in the sword:depositedBy term
* If present, the sword:originalDeposit term MAY include the user on whose behalf the deposit was made in the sword:depositedOnBehalfOf term
* The statement MAY include any other ORE terms, and any other terms from other ontologies

For example:

<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:ore="http://www.openarchives.org/ore/terms/">
    <rdf:Description rdf:about="http://localhost:8080/edit-uri/43/62">
      <ore:describes rdf:resource="http://localhost:8080/agg-uri/43/62"/>
    </rdf:Description>
    <rdf:Description rdf:about="http://localhost:8080/agg-uri/43/62">
      <ore:isDescribedBy rdf:resource="http://localhost:8080/edit-uri/43/62"/>
      <ore:aggregates rdf:resource="http://localhost:8080/part-uri/43/62/example.zip"/>
      <sword:originalDeposit rdf:resource="http://localhost:8080/part-uri/43/62/example.zip"/>
      <sword:state rdf:resource="http://purl.org/net/sword/state/archived"/>
    </rdf:Description>
    <rdf:Description rdf:about="http://localhost:8080/part-uri/43/62/example.zip">
      <sword:packaging rdf:resource="http://purl.org/net/sword/package/default"/>
      <sword:depositedOn rdf:datatype="http://www.w3.org/2001/XMLSchema#dateTime">2011-02-25T14:40:09Z</sword:depositedOn>
      <sword:depositedBy rdf:datatype="http://www.w3.org/2001/XMLSchema#string">sword</sword:depositedBy>
    </rdf:Description>
    <rdf:Description rdf:about="http://purl.org/net/sword/state/archived">
      <sword:stateDescription>The work has passed through review and is now in the archive</sword:stateDescription>
    </rdf:Description>
  </rdf:RDF>

The client's responsibilities are:

* If no sword:packaging term is provided on sword:originalDeposit, the client MUST assume only the default packaging format
* The client MUST ignore without error any terms in the document that it does not understand
* The client SHOULD recognise parts of the resource map which are not identified with sword:originalDeposit terms as content of the item, and represent them appropriately


12.3 Atom Serialisation

The SWORD statement can be provided as an Atom Feed [AtomPub] with sword extensions.  For an Atom Feed document to comply with the requirements of the SWORD statement it needs to meet the following requirements but is not constrained in any way as to what additional data is provided alongside.  As such, it is expected that the SWORD statement may be included with existing serialisations provided by the server, such as with any GData [GData] extensions.

The responsibilities of the server are:

* The Feed MUST represent each file contained in the item as an atom:entry element
* Each atom:entry which is an original deposit file MUST have an atom:category element with the term sword:originalDeposit (this does not mandate that all original deposits are listed as entries)
* The Feed MAY specify a state for the item on the server with the sword:state term as foreign XML markup in the root atom:feed element
* If present, the sword:state term SHOULD include a human readable description in the sword:stateDescription term
* Each atom:entry which is an original deposit MAY include one or more sword:packaging terms as foreign markup in the atom:entry
* Each atom:entry which is an original deposit MAY include the date the package was originally deposited in the sword:depositedOn term as foreign markup in the atom:entry
* Each atom:entry which is an original deposit MAY include the depositor of the package in the sword:depositedBy term as foreign markup in the atom:entry
* Each atom:entry which is an original deposit MAY include the user on whose behalf the deposit was made in the sword:depositedOnBehalfOf term as foreign markup in the atom:entry
* The statement MAY include any other foreign markup and legitimate atom extensions

For example:

<atom:feed xmlns:sword="http://purl.org/net/sword/terms/" xmlns:atom="http://www.w3.org/2005/Atom">
  <sword:state href="http://purl.org/net/sword/state/archived">
    <sword:stateDescription>The work has passed through review and is now in the archive</sword:stateDescription>
  </sword:state>
  <atom:entry>
    <atom:category scheme="http://purl.org/net/sword/terms/" 
		term="http://purl.org/net/sword/terms/originalDeposit" 
		label="Orignal Deposit"/>
    <atom:content type="application/zip" src="http://localhost:8080/part-uri/43/13/example.zip"/>
    <sword:packaging>http://purl.org/net/sword/package/default</sword:packaging>
    <sword:depositedOn>2011-03-02T20:50:06Z</sword:depositedOn>
    <sword:depositedBy>sword</sword:depositedBy>
    <sword:depositedOnBehalfOf>jbloggs</sword:depositedBy>
  </atom:entry>
</atom:feed>


The client's responsibilities are:

* If no sword:packaging term is provided on sword:originalDeposit, the client MUST assume only the default packaging format
* The client MUST ignore without error any terms in the document that it does not understand


13. Error Documents

SWORD adds a new class of document to [AtomPub] that gives server implementations the ability to describe error conditions more fully than HTTP response codes allow. If a server is reporting an error condition in response to a resource POST, it SHOULD also return a document with a root element of sword:error. The sword:error element SHOULD have an href attribute containing a URI that identifies the error. Errors in the SWORD namespace are reserved and legal values are enumerated below. Implementations MAY define their own errors, but MUST use a different namespace to do so.

The sword:error element MAY contain any of the elements normally used in Entry Documents (See Part B Section 9.8), but does not to the meet the requirements of Entry Documents (e.g. an atom:id element is not required).

13.1 Error URIs

13.1.1 sword:ErrorContent

URI: http://purl.org/net/sword/error/ErrorContent	

The supplied format is not the same as that identified in the Packaging header and/or that supported by the server 

13.1.2 sword:ErrorChecksumMismatch

URI: http://purl.org/net/sword/error/ErrorChecksumMismatch	

Checksum sent does not match the calculated checksum. The server MUST also return a status code of 412 Precondition Failed.

13.1.3 sword:ErrorBadRequest
 
URI: http://purl.org/net/sword/error/ErrorBadRequest	

Some parameters sent with the POST were not understood. The server MUST also return a status code of 400 Bad Request.

13.1.4 sword:TargetOwnerUnknown

URI: http://purl.org/net/sword/error/TargetOwnerUnknown	

Used in mediated deposit when the server does not know the identity of the On-Behalf-Of user.

13.1.5 sword:MediationNotAllowed

URI http://purl.org/net/sword/error/MediationNotAllowed	

Used where a client has attempted a mediated deposit, but this is not supported by the server. The server MUST also return a status code of 412 Precondition Failed.

13.1.6 sword:MethodNotAllowed

URI: http://purl.org/net/sword/error/MethodNotAllowed

Used when the client has attempted one of the HTTP update verbs (POST, PUT, DELETE) but the server has decided not to respond to such requests on the specified resource at that time.  The server MUST also return a status code of 405 Method Not Allowed

5.2 Error Document Example

HTTP 1.1  400 Bad Request
<?xml version="1.0" encoding="utf-8"?>
<sword:error xmlns="http://www.w3.org/2005/Atom"
       xmlns:sword="http://purl.org/net/sword/"
       xmlns:arxiv="http://arxiv.org/schemas/atom"
       href="http://example.org/errors/BadManifest">
  <author>
    <name>Example repository</name>
  </author>
  <title>ERROR</title>
  <updated>2008-02-19T09:34:27Z</updated>

  <generator uri="https://example.org/sword-app/"
               version="0.9">sword@example.org</generator>

  <summary>The manifest could be parsed, but was not valid - 
  no technical metadata was provided.</summary>
  <sword:treatment>processing failed</sword:treatment>
  <link rel="alternate" href="https://arxiv.org/help" type="text/html"/>

</sword:error>

14. Auto-Discovery

AtomPub makes no recommendations on the discovery of Service Documents. SWORD RECOMMENDS that server implementations use an <html:link rel="sword" href="[Service Document URL]"/> element in the head of a relevant HTML document to assist with service discovery.


15. References

[Atom] Nottingham, M. and R. Sayre, "The Atom Syndication Format", RFC 4287, December 2005. http://www.ietf.org/rfc/rfc4287.txt (see also non-normative html version at http://APP.org/rfc4287.html)

[AtomPub] Gregario, J. and B. de hOra, "The Atom Publishing Protocol", RFC 5023, October 2007. http://www.ietf.org/rfc/rfc5023.txt (see also non-normative html version at http://bitworking.org/projects/atom/rfc5023.html) 

[RFC2616] Fielding et al, "Hypertext Transfer Protocol -- HTTP/1.1", RFC 2616, June 1999 http://www.w3.org/Protocols/rfc2616/rfc2616.html 

[RFC2183] Troost, R., Dorner, S. and Moore, K., "Communicating Presentation Information in Internet Messages: The Content-Disposition Header Field", RFC 2183, August 1997 http://www.ietf.org/rfc/rfc2183.txt

[OAUTH] Atwood, A., Conlan, R. et al OAuth Core 1.0 http://oauth.net/core/1.0/, December 2007

[ORE] Lagoze, C., Van de Sompel, H et al, Open Archives Initiative Object Reuse and Exchange, http://www.openarchives.org/ore/, June 2008

[RFC2617] Franks, J. et al, "HTTP Authentication: Basic and Digest Access Authentication". http://www.ietf.org/rfc/rfc2617.txt , June 1999 

[RFC2818] Rescorla, E. "HTTP over TLS". http://www.ietf.org/rfc/rfc2818.txt, May 2000.

[RFC2119] Bradner, S. "Key words for use in RFCs to Indicate Requirement Levels". http://www.ietf.org/rfc/rfc2119.txt, March 1997.

[SWORD001] Jones, R. "Packaged Content Delivery over HTTP", February 2011

[SWORD002] Jones, R. "AtomPub Extensions for Packaged Content", February 2011

[SWORD003] Jones, R. "AtomPub Extensions for Scholarly Systems", February 2011

[SWORD004] Jones, R. "Atom Multipart Extensions for Packaged Content", February 2011

[AtomMultipart] Gregario, J, et al "AtomPub Multipart Media Resource Creation", September 2008

[DublinCore]

</body>
</html>
